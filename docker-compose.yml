services:
  tests:
    build: .
    volumes:
      - ./src:/app/src
      - ./tests:/app/tests
      - ./examples:/app/examples
      - ./vendor:/app/vendor
      - ./phpunit.xml:/app/phpunit.xml
      - ./composer.json:/app/composer.json
    environment:
      - LLM_API_KEY=${LLM_API_KEY:-}
      - LLM_BASE_URL=${LLM_BASE_URL:-https://api.openai.com/v1}
      - ELEVENLABS_API_KEY=${ELEVENLABS_API_KEY:-}
      - ELEVENLABS_AGENT_ID=${ELEVENLABS_AGENT_ID:-}

  cs-fix:
    build: .
    entrypoint: ["php", "/app/vendor/bin/php-cs-fixer"]
    command: ["fix", "--diff"]
    volumes:
      - ./src:/app/src
      - ./tests:/app/tests
